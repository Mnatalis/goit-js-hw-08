{"mappings":"oeACA,IAAAA,EAAAC,EAAA,SAEA,MAAMC,EAAOC,SAASC,cAAc,sBACpC,SAASC,IACP,MAAMC,EAAiBC,aAAaC,QAAQ,uBACtCC,EAAc,CAChBC,MAAO,GACPC,QAAS,IAEb,GAAGL,EACC,IACI,MAAMM,EAAaC,KAAKC,MAAMR,GAC9BS,OAAOC,KAAKP,GAAaQ,SAASC,IAC9BT,EAAYS,GAAON,EAAWM,EAAI,G,CAExC,MAAMC,GACJC,QAAQC,KAAKF,E,CAGrB,OAAOV,C,CAaT,SAASa,EAAcC,GACnB,MAAMC,EAAiC,KAAtBD,EAAKE,MAAMC,OACtBC,EAAeJ,EAAKK,WAAWC,SAKrC,GAJIF,EAAaG,OAAS,GACbH,EAAa,GAAGI,UAAUC,SAAS,cAC9CL,EAAa,GAAGM,SAEfT,EAAQ,CACT,MAAMU,EAAU/B,SAASgC,cAAc,QACvCD,EAAQH,UAAUK,IAAI,aACtBF,EAAQG,MAAMC,SAAW,OACzBJ,EAAQK,YAAc,6BACtBhB,EAAKK,WAAWY,OAAON,E,CAEzB,OAAQV,C,EAxBZ,WACE,MAAMf,EAAcJ,IACpBU,OAAOC,KAAKP,GAAaQ,SAASC,IAC9B,MAAMK,EAAOpB,SAASC,cAAc,UAAUc,OAC3CK,IACCA,EAAKE,MAAQhB,EAAYS,GAAI,G,CAiDvCuB,GAEAvC,EAAKwC,iBAAiB,SAAS,EAAA1C,EAAA2C,WAX/B,SAAiBC,GAEb,MAAMnC,EAAcJ,IACpBI,EAAYmC,EAAGC,OAAOC,MAAQF,EAAGC,OAAOpB,MACrCH,EAAcsB,EAAGC,SAClBtC,aAAawC,QAAQ,sBAAuBlC,KAAKmC,UAAUvC,G,GAMhB,MACjDP,EAAKwC,iBAAiB,UAAWE,IAC7B,MAAMnC,EAAcJ,IACpBuC,EAAGK,iBAhCP,SAAkBC,GACd,MAAMC,EAAWD,EAAKC,SAChB1C,EAAcJ,IAKpB,OAJkBU,OAAOC,KAAKP,GAAa2C,QAAO,CAACC,EAAKnC,KACtD,MAAMM,GAAWF,EAAc6B,EAASjC,IACxC,OAASmC,IAAS7B,CAAO,IACxB,E,CA2BC8B,CAASV,EAAGW,kBAvBpB,SAAqBC,GACjB,MAAML,EAAWK,EAAKL,SAChB1C,EAAcJ,IACFU,OAAOC,KAAKP,GAAaQ,SAASC,IAClDiC,EAASjC,GAAKO,MAAQ,EAAE,G,CAsB1BgC,CAAYb,EAAGW,eACfnC,QAAQsC,IAAIjD,GACZF,aAAaoD,WAAW,uBACxBvC,QAAQsC,IAAI,mDAAkD","sources":["src/js/03-feedback.js"],"sourcesContent":["// import throttle from 'lodash.throttle';\nimport {throttle} from 'lodash';\n\nconst form = document.querySelector(\"form.feedback-form\");\nfunction readStorage(){\n  const storageRawData = localStorage.getItem(\"feedback-form-state\");\n  const storageData = {\n      email: \"\",\n      message: \"\"\n  };\n  if(storageRawData){\n      try{\n          const parsedData = JSON.parse(storageRawData);\n          Object.keys(storageData).forEach((key) =>{\n              storageData[key] = parsedData[key];\n          });\n      } catch(exc){\n          console.warn(exc);\n      }\n  }\n  return storageData;\n}\n\nfunction writeStorageValues(){\n  const storageData = readStorage();\n  Object.keys(storageData).forEach((key) =>{\n      const elem = document.querySelector(`[name=\"${key}\"]`);\n      if(elem){\n          elem.value = storageData[key];\n      }\n  });\n}\n\nfunction validateEmpty(elem){\n    const isEmpty = (elem.value.trim() === '');\n    const elemChildren = elem.parentNode.children;\n    if( elemChildren.length > 1 \n              && elemChildren[1].classList.contains(\"error-msg\") ){\n      elemChildren[1].remove();\n    }\n    if(isEmpty){\n      const elemMsg = document.createElement(\"SPAN\");\n      elemMsg.classList.add('error-msg');\n      elemMsg.style.fontSize = '11px';\n      elemMsg.textContent = 'This field cannot be empty';\n      elem.parentNode.append(elemMsg);\n    }\n    return !isEmpty;\n}\n\nfunction validate(form){\n    const elements = form.elements;\n    const storageData = readStorage();\n    const allFilled = Object.keys(storageData).reduce((acc, key) => {\n      const isEmpty = !validateEmpty(elements[key]);\n      return ( acc && (!isEmpty) );\n    }, true);\n    return allFilled;\n}\n\nfunction clearInputs(form){\n    const elements = form.elements;\n    const storageData = readStorage();\n    const allFilled = Object.keys(storageData).forEach((key) => {\n      elements[key].value = '';\n    });\n}\n\nfunction onInput(ev){\n    //console.log(ev.target.name, ev.target.value);\n    const storageData = readStorage();\n    storageData[ev.target.name] = ev.target.value;\n    if(validateEmpty(ev.target)){\n      localStorage.setItem(\"feedback-form-state\", JSON.stringify(storageData));\n    }\n}\n\nwriteStorageValues();\n\nform.addEventListener(\"input\", throttle(onInput, 500));\nform.addEventListener(\"submit\", (ev) => {\n    const storageData = readStorage();\n    ev.preventDefault();\n    if(!validate(ev.currentTarget)){\n      return ;\n    }\n    clearInputs(ev.currentTarget);\n    console.log(storageData);\n    localStorage.removeItem(\"feedback-form-state\");\n    console.log('localStorage[\"feedback-form-state\"] was removed')\n})\n"],"names":["$kEUo3","parcelRequire","$945622fd0f572e60$var$form","document","querySelector","$945622fd0f572e60$var$readStorage","storageRawData","localStorage","getItem","storageData","email","message","parsedData","JSON","parse","Object","keys","forEach","key","exc","console","warn","$945622fd0f572e60$var$validateEmpty","elem","isEmpty","value","trim","elemChildren","parentNode","children","length","classList","contains","remove","elemMsg","createElement","add","style","fontSize","textContent","append","$945622fd0f572e60$var$writeStorageValues","addEventListener","throttle","ev","target","name","setItem","stringify","preventDefault","form1","elements","reduce","acc","$945622fd0f572e60$var$validate","currentTarget","form2","$945622fd0f572e60$var$clearInputs","log","removeItem"],"version":3,"file":"03-feedback.01329c6f.js.map"}